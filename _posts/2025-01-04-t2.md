---
title: 流程 · C++ 代码格式化
categories: [工作]
comments: true
---

​	使用 Clang Format 进行代码的格式化。

##### 一、下载插件

​	在 Qt Creator > 关于插件 > Beautifier 路径，勾选，重启 Qt Creator

##### 二、开启格式化

​	在 Qt Creator > 编辑 > Preferences > 美化器 > 概要 勾选 `文件保存时自动格式化` 选项；并将工具切换为 `ClangForamt` 选项。在 `ClangForamt` 选项卡中选择格式化命令路径，一般在 `$$Custom\Qt\Tools\QtCreator\bin\clang\bin\clang-format.exe` 位置。

##### 三、自定义代码风格

​	勾选 `使用自定义风格` 选项，点击 `添加` 按钮，添加风格名称（随意）和风格的值（可拷贝后续）后，点击确认。

> 风格地址：https://clang.llvm.org/docs/ClangFormatStyleOptions.html

##### 四、注意事项

​	风格代码一般会保存在以下目录:

```
C:\Users\<User Name>\AppData\Roaming\QtProject\qtcreator\beautifier\clangformat
```

> 如果风格代码中有中文注释，需要修改它的编码为 UTF-8 编码，否则格式化会不生效。

##### 五、风格偏好

```ini
# Version 19.1.0
# 编程语言: None, Cpp, Java, JavaScript, ObjC, Proto, TableGen, TextProto
Language: Cpp

# 基础样式
BasedOnStyle: Google

#指针的*的挨着哪边,例如int* a
PointerAlignment: Right

ReferenceAlignment: Right

# 访问修饰符前的空格,例如public,private等
AccessModifierOffset: -4

# 缩进宽度
IndentWidth: 4

# 要保留的最大连续空行数
MaxEmptyLinesToKeep: 1

# 大括号{}的换行方式,数值是Allman或Attach
BreakBeforeBraces: Allman

# 是否允许短方法单行,例如int f() { return 0; }
AllowShortFunctionsOnASingleLine: Inline

# 支持一行的if,例如值为true，则可以放在一行上。if (a) return;
AllowShortIfStatementsOnASingleLine: true

# 在未封闭(括号的开始和结束不在同一行)的括号中的代码是否对齐,为true,则将参数在左方括号后水平对齐
AlignAfterOpenBracket: false

# 针对OC的block的缩进宽度
ObjCBlockIndentWidth: 4

# 针对OC，属性名后加空格
ObjCSpaceAfterProperty: true

# 每行字符的长度
ColumnLimit: 0

# 注释对齐
AlignTrailingComments:
  Kind: Always
  OverEmptyLines: 2

# 换行的时候对齐操作符
AlignOperands: true

# 在构造函数初始化时按逗号断行，并以冒号对齐
BreakConstructorInitializersBeforeComma: true

# 函数参数换行
AllowAllParametersOfDeclarationOnNextLine: true

#在续行(#下一行)时的缩进长度
ContinuationIndentWidth: 4

# tab键盘的宽度
TabWidth: 4

# 赋值运算符前加空格
SpaceBeforeAssignmentOperators: true

# 行尾的注释前加1个空格
SpacesBeforeTrailingComments: 1

AllowShortLambdasOnASingleLine: Empty
LambdaBodyIndentation: OuterScope

# 定义何时在访问修饰符之后放置空行
EmptyLineAfterAccessModifier: Never

# 要使用的行尾样式
LineEnding: LF

# 排列说明符和限定符
QualifierAlignment: Left

SpaceBeforeRangeBasedForLoopColon: true
SpaceInEmptyBlock: true
SpacesInContainerLiterals: true
```

